name: Scheduled Job Scraper

on:
  schedule:
    # Runs every minute between 6:00 AM and 9:30 PM IST
    # IST is UTC+5.5. 6:00 AM IST = 00:30 UTC. 9:30 PM IST = 16:00 UTC.
    # The cron format is minute hour day month day-of-week.
    # This runs every minute from hour 0 to 15 UTC.
    - cron: '* 0-15 * * *'
  workflow_dispatch: # Allows you to trigger it manually from the GitHub UI

jobs:
  run-scraper:
    runs-on: ubuntu-latest
    timeout-minutes: 5 # Set a timeout for the whole job
    steps:
      - name: Trigger Vercel Function
        run: |
          echo "Triggering URL: ${{ secrets.VERCEL_APP_URL }}/post-single"
          curl --fail --silent --show-error --max-time 120 "${{ secrets.VERCEL_APP_URL }}/post-single"
        env:
          # Make sure the secret is set correctly in your repo settings
          VERCEL_APP_URL: ${{ secrets.VERCEL_APP_URL }}
